<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NABI SYSTEM Sorgu Paneli</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary: #8b5cf6;
      --primary-dark: #7c3aed;
      --primary-light: #a78bfa;
      --secondary: #06b6d4;
      --accent: #f59e0b;
      --success: #10b981;
      --error: #ef4444;
      --warning: #f59e0b;
      --background: #0f0f23;
      --surface: #1a1b2f;
      --surface-light: #252642;
      --text: #f8fafc;
      --text-secondary: #cbd5e1;
      --text-muted: #94a3b8;
      --glass: rgba(255, 255, 255, 0.05);
      --glass-border: rgba(255, 255, 255, 0.08);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(135deg, var(--background) 0%, #1e1b4b 100%);
      color: var(--text);
      min-height: 100vh;
      line-height: 1.6;
      overflow-x: hidden;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      display: grid;
      grid-template-columns: 1fr 400px;
      gap: 24px;
      min-height: 100vh;
    }

    /* Header Styles */
    .header {
      grid-column: 1 / -1;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 0;
      border-bottom: 1px solid var(--glass-border);
      margin-bottom: 24px;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo-icon {
      width: 48px;
      height: 48px;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      font-weight: bold;
      color: white;
      box-shadow: 0 8px 32px rgba(139, 92, 246, 0.3);
    }

    .logo-text {
      font-size: 24px;
      font-weight: 800;
      background: linear-gradient(135deg, var(--text), var(--primary-light));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .nav-actions {
      display: flex;
      gap: 12px;
    }

    .btn {
      padding: 12px 24px;
      border-radius: 10px;
      border: none;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      text-decoration: none;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: white;
      box-shadow: 0 4px 16px rgba(139, 92, 246, 0.3);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(139, 92, 246, 0.4);
    }

    .btn-secondary {
      background: var(--glass);
      color: var(--text);
      border: 1px solid var(--glass-border);
      backdrop-filter: blur(10px);
    }

    .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.08);
      transform: translateY(-2px);
    }

    /* Main Content */
    .main-content {
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    .query-card {
      background: var(--surface);
      border-radius: 20px;
      padding: 32px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      border: 1px solid var(--glass-border);
      backdrop-filter: blur(10px);
    }

    .card-header {
      margin-bottom: 24px;
    }

    .card-title {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 8px;
      background: linear-gradient(135deg, var(--text), var(--primary-light));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .card-subtitle {
      color: var(--text-secondary);
      font-size: 14px;
    }

    .api-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: white;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      margin-top: 8px;
    }

    /* Form Styles */
    .form-group {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .input-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .input-label {
      font-weight: 600;
      color: var(--text);
      font-size: 14px;
    }

    .input-field {
      padding: 16px;
      border-radius: 12px;
      border: 1px solid var(--glass-border);
      background: rgba(255, 255, 255, 0.03);
      color: var(--text);
      font-size: 16px;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }

    .input-field:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
      background: rgba(255, 255, 255, 0.05);
    }

    .input-field::placeholder {
      color: var(--text-muted);
    }

    .submit-btn {
      width: 100%;
      padding: 16px;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin-top: 8px;
    }

    .submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(139, 92, 246, 0.4);
    }

    .submit-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    /* Results Section */
    .results-card {
      background: var(--surface);
      border-radius: 20px;
      padding: 32px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      border: 1px solid var(--glass-border);
      backdrop-filter: blur(10px);
    }

    .results-header {
      display: flex;
      justify-content: between;
      align-items: center;
      margin-bottom: 20px;
    }

    .results-title {
      font-size: 20px;
      font-weight: 700;
      color: var(--text);
    }

    .results-content {
      min-height: 200px;
      max-height: 600px;
      overflow-y: auto;
    }

    .loading {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 16px;
      padding: 40px;
      color: var(--text-secondary);
    }

    .loading-spinner {
      width: 40px;
      height: 40px;
      border: 3px solid rgba(139, 92, 246, 0.3);
      border-top: 3px solid var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .result-item {
      background: rgba(255, 255, 255, 0.03);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 16px;
      border: 1px solid var(--glass-border);
    }

    .result-item:last-child {
      margin-bottom: 0;
    }

    .result-field {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }

    .result-field:last-child {
      border-bottom: none;
    }

    .field-label {
      font-weight: 600;
      color: var(--text-secondary);
      min-width: 120px;
    }

    .field-value {
      color: var(--text);
      text-align: right;
      flex: 1;
    }

    .error-message {
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.3);
      color: #fca5a5;
      padding: 16px;
      border-radius: 12px;
      text-align: center;
    }

    .success-message {
      background: rgba(16, 185, 129, 0.1);
      border: 1px solid rgba(16, 185, 129, 0.3);
      color: #6ee7b7;
      padding: 16px;
      border-radius: 12px;
      text-align: center;
    }

    .json-result {
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid var(--glass-border);
      border-radius: 8px;
      padding: 16px;
      margin-top: 12px;
      max-height: 400px;
      overflow: auto;
    }

    .json-result pre {
      margin: 0;
      white-space: pre-wrap;
      word-wrap: break-word;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      color: var(--text);
    }

    /* Sidebar */
    .sidebar {
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    .info-card {
      background: var(--surface);
      border-radius: 20px;
      padding: 24px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      border: 1px solid var(--glass-border);
      backdrop-filter: blur(10px);
    }

    .info-title {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 16px;
      color: var(--text);
    }

    .stats-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .stat-item {
      background: rgba(255, 255, 255, 0.03);
      border-radius: 12px;
      padding: 16px;
      text-align: center;
      border: 1px solid var(--glass-border);
    }

    .stat-value {
      font-size: 24px;
      font-weight: 800;
      color: var(--primary);
      margin-bottom: 4px;
    }

    .stat-label {
      font-size: 12px;
      color: var(--text-secondary);
      font-weight: 600;
    }

    .feature-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .feature-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 10px;
      border: 1px solid var(--glass-border);
    }

    .feature-icon {
      width: 32px;
      height: 32px;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 14px;
    }

    .feature-text {
      font-size: 14px;
      color: var(--text);
    }

    /* Responsive */
    @media (max-width: 968px) {
      .container {
        grid-template-columns: 1fr;
      }
      
      .sidebar {
        order: -1;
      }
    }

    @media (max-width: 768px) {
      .header {
        flex-direction: column;
        gap: 16px;
        text-align: center;
      }
      
      .nav-actions {
        width: 100%;
        justify-content: center;
      }
      
      .query-card,
      .results-card,
      .info-card {
        padding: 24px;
      }
    }

    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 6px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb {
      background: var(--primary);
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--primary-dark);
    }

    /* Result item styling */
    .result-title {
      font-size: 18px;
      font-weight: 700;
      color: var(--primary-light);
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .result-title i {
      font-size: 16px;
    }

    .result-section {
      margin-bottom: 16px;
    }

    .result-section:last-child {
      margin-bottom: 0;
    }

    .section-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-secondary);
      margin-bottom: 8px;
      padding-bottom: 4px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header class="header">
      <div class="logo">
        <div class="logo-icon">
          <i class="fas fa-shield-alt"></i>
        </div>
        <div class="logo-text">NEM Sorgu</div>
      </div>
      <div class="nav-actions">
        <a href="/panel" class="btn btn-secondary">
          <i class="fas fa-arrow-left"></i>Panele Dön
        </a>
        <a href="/" class="btn btn-primary">
          <i class="fas fa-home"></i>Ana Sayfa
        </a>
      </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Query Form Card -->
      <section class="query-card">
        <div class="card-header">
          <h1 class="card-title" id="form-title">Sorgu Paneli</h1>
          <p class="card-subtitle">Güvenli ve hızlı sorgulama için bilgileri girin</p>
          <div class="api-badge" id="api-badge">
            <i class="fas fa-code"></i>
            <span id="api-name">API Seçilmedi</span>
          </div>
        </div>
        
        <form id="queryForm" class="form-group">
          <!-- Form inputs will be dynamically inserted here -->
        </form>
      </section>

      <!-- Results Card -->
      <section class="results-card">
        <div class="results-header">
          <h2 class="results-title">Sorgu Sonuçları</h2>
        </div>
        <div class="results-content" id="result">
          <div class="loading" id="default-state">
            <div class="loading-spinner"></div>
            <p>Sorgu sonuçları burada görünecek</p>
          </div>
        </div>
      </section>
    </main>

    <!-- Sidebar -->
    <aside class="sidebar">
      <!-- Stats Card -->
      <div class="info-card">
        <h3 class="info-title">İstatistikler</h3>
        <div class="stats-grid">
          <div class="stat-item">
            <div class="stat-value" id="stat-queries">0</div>
            <div class="stat-label">Toplam Sorgu</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="stat-success">0</div>
            <div class="stat-label">Başarılı</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="stat-users">0</div>
            <div class="stat-label">Aktif Kullanıcı</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="stat-uptime">%99.9</div>
            <div class="stat-label">Sistem Durumu</div>
          </div>
        </div>
      </div>

      <!-- Features Card -->
      <div class="info-card">
        <h3 class="info-title">Özellikler</h3>
        <div class="feature-list">
          <div class="feature-item">
            <div class="feature-icon">
              <i class="fas fa-bolt"></i>
            </div>
            <div class="feature-text">Yüksek Hız</div>
          </div>
          <div class="feature-item">
            <div class="feature-icon">
              <i class="fas fa-shield-alt"></i>
            </div>
            <div class="feature-text">Güvenli Sorgu</div>
          </div>
          <div class="feature-item">
            <div class="feature-icon">
              <i class="fas fa-database"></i>
            </div>
            <div class="feature-text">Güncel Veriler</div>
          </div>
          <div class="feature-item">
            <div class="feature-icon">
              <i class="fas fa-mobile-alt"></i>
            </div>
            <div class="feature-text">Mobil Uyumlu</div>
          </div>
        </div>
      </div>

      <!-- API Info Card -->
      <div class="info-card">
        <h3 class="info-title">API Bilgisi</h3>
        <div class="feature-list">
          <div class="feature-item">
            <div class="feature-icon">
              <i class="fas fa-info-circle"></i>
            </div>
            <div class="feature-text">
              <strong>API:</strong> <span id="current-api">-</span>
            </div>
          </div>
          <div class="feature-item">
            <div class="feature-icon">
              <i class="fas fa-clock"></i>
            </div>
            <div class="feature-text">
              <strong>Yanıt Süresi:</strong> <1sn
            </div>
          </div>
          <div class="feature-item">
            <div class="feature-icon">
              <i class="fas fa-check-circle"></i>
            </div>
            <div class="feature-text">
              <strong>Durum:</strong> <span style="color: var(--success)">Aktif</span>
            </div>
          </div>
        </div>
      </div>
    </aside>
  </div>

  <script>
    // API configuration
    const api = new URLSearchParams(window.location.search).get('api');
    const formTitle = document.getElementById('form-title');
    const apiName = document.getElementById('api-name');
    const currentApi = document.getElementById('current-api');
    const form = document.getElementById('queryForm');
    const resultDiv = document.getElementById('result');
    const defaultState = document.getElementById('default-state');

    const apiInputs = {
      // TC tabanlı sorgular
      'TC Sorgulama': ['tc'],
      'TC PRO Sorgulama': ['tc'],
      'Yaş Sorgulama': ['tc'],
      'Ad Soyad PRO Sorgulama': ['tc'],
      'İş Yeri Sorgulama': ['tc'],
      'TC GSM Sorgulama': ['tc'],
      'Adres Sorgulama': ['tc'],
      'Hane Sorgulama': ['tc'],
      'Apartman Sorgulama': ['tc'],
      'Aile Sorgulama': ['tc'],
      'Aile PRO Sorgulama': ['tc'],
      'Eş Sorgulama': ['tc'],
      'Sülale Sorgulama': ['tc'],
      'LGS Sorgulama': ['tc'],
      'E-Kurs Sorgulama': ['tc', 'okulno'],
      'Mhrs Randevu Sorgulama': ['tc'],
      'Prem Adres Sorgulama': ['tc'],
      'SGK PRO Sorgulama': ['tc'],
      'Vergi Levhası Sorgulama': ['tc'],
      'Diploma Sorgulama': ['tc'],
      'Başvuru Sorgulama': ['tc'],
      'Nöbetçi Eczane Sorgulama': ['tc'],
      'Randevu Sorgulama': ['tc'],
      'İnternet Sorgulama': ['tc'],
      'Personel Sorgulama': ['tc'],
      'Üniversite Öğrenci Sorgulama': ['tc'],
      'Sertifika Sorgulama (Hanedan)': ['tc'],
      'LGS Sorgulama (Hanedan)': ['tc'],
      'Muhalle Sorgulama': ['tc'],
      'Vesika Sorgulama (Hanedan)': ['tc'],
      'Ehliyet Sorgulama': ['tc'],
      'Boy Sorgulama': ['tc'],
      'Ayak No Sorgulama': ['tc'],
      'CM Sorgulama': ['tc'],
      'Burç Sorgulama': ['tc'],
      'Çocuk Sorgulama': ['tc'],
      'Baba Sorgulama': ['tc'],
      'Anne Sorgulama': ['tc'],

      // Ad/Soyad tabanlı sorgular
      'Ad Soyad Sorgulama': ['ad', 'soyad'],
      'Adı İl İlçe Sorgulama': ['ad', 'il'],
      'Prem Ad Sorgulama': ['ad', 'il', 'ilce'],
      'Interpol Sorgulama': ['ad', 'soyad'],
      'Şehit Sorgulama': ['ad', 'soyad'],
      'Öğretmen Sorgulama': ['ad', 'soyad'],
      'Yabancı Sorgulama': ['ad', 'soyad'],

      // GSM/Plaka sorguları
      'GSM TC Sorgulama': ['gsm'],
      'Operatör Sorgulama': ['gsm'],
      'Araç Parça Sorgulama': ['plaka'],
      'Araç Borç Sorgulama': ['plaka'],
      'Plaka Sorgulama (Hanedan)': ['plaka'],
      'Plaka İsim Sorgulama': ['isim'],
      'Plaka Borç Sorgulama': ['plaka'],

      // Domain/IP sorguları
      'IP Sorgulama': ['domain'],
      'DNS Sorgulama': ['domain'],
      'Whois Sorgulama': ['domain'],
      'Subdomain Sorgulama': ['url'],
      'Leak Sorgulama': ['query'],
      'Site Log Sorgulama': ['site'],
      'Hexnox Subdomain Sorgulama': ['url'],
      'Subdomain Generic Sorgulama': ['url'],

      // Diğer sorgular
      'Telegram Sorgulama': ['kullanici'],
      'Şifre Encrypt': ['method', 'password'],
      'Facebook Kullanıcı Sorgulama (Hanedan)': ['numara'],
      'Hava Durumu Sorgulama': ['sehir'],
      'Email Sorgulama': ['email'],
      'İMEI Sorgulama': ['imei'],
      'Vergi No Sorgulama': ['vergi'],
      'Firma Ünvan Sorgulama': ['unvan'],
      'İş Kaydı Sorgulama': ['adsoyad'],
      'Papara No Sorgulama': ['paparano'],
      'İninal No Sorgulama': ['ininal_no'],
      'TurkNet Sorgulama': ['tc'],
      'Seri No Sorgulama': ['tc'],
      'Craftrise Kullanıcı Sorgu': ['ad'],
      'AI Fotoğraf Üretici': ['img'],
      'Instagram Kullanıcı Sorgulama': ['usr'],
      'Seçmen Sorgulama': ['tc'],
      'Tapu Sorgulama (Hanedan)': ['tc'],
      'Ada Parsel Sorgulama': ['il', 'ada', 'parsel']
    };

    // Input labels
    const inputLabels = {
      'tc': 'TC Kimlik No',
      'ad': 'Ad',
      'soyad': 'Soyad', 
      'il': 'İl',
      'ilce': 'İlçe',
      'okulno': 'Okul Numarası',
      'gsm': 'Telefon Numarası',
      'plaka': 'Plaka',
      'isim': 'İsim',
      'domain': 'Domain/IP',
      'url': 'URL',
      'query': 'Arama Sorgusu',
      'kullanici': 'Kullanıcı Adı',
      'method': 'Şifreleme Metodu',
      'password': 'Şifre',
      'numara': 'Telefon Numarası',
      'sehir': 'Şehir',
      'email': 'E-posta',
      'imei': 'IMEI Numarası',
      'vergi': 'Vergi Numarası',
      'unvan': 'Firma Ünvanı',
      'adsoyad': 'Ad Soyad',
      'paparano': 'Papara Numarası',
      'ininal_no': 'İninal Numarası',
      'img': 'Görsel URL',
      'usr': 'Kullanıcı Adı',
      'ada': 'Ada No',
      'parsel': 'Parsel No',
      'site': 'Site URL'
    };

    // Build the form dynamically
    function buildForm() {
      const inputs = apiInputs[api];
      
      if (!inputs) {
        formTitle.textContent = 'Geçersiz Sorgu';
        apiName.textContent = 'Geçersiz API';
        currentApi.textContent = 'Geçersiz';
        form.innerHTML = '<div class="error-message">Geçersiz veya desteklenmeyen sorgu türü.</div>';
        return;
      }

      // Update titles
      formTitle.textContent = `${api} Sorgusu`;
      apiName.textContent = api;
      currentApi.textContent = api;

      // Build form inputs
      form.innerHTML = '';
      
      inputs.forEach(inputName => {
        const inputGroup = document.createElement('div');
        inputGroup.className = 'input-group';
        
        const label = document.createElement('label');
        label.className = 'input-label';
        label.textContent = inputLabels[inputName] || inputName;
        label.htmlFor = inputName;
        
        const input = document.createElement('input');
        input.type = 'text';
        input.id = inputName;
        input.name = inputName;
        input.className = 'input-field';
        input.placeholder = `${inputLabels[inputName] || inputName} girin...`;
        input.required = true;
        
        inputGroup.appendChild(label);
        inputGroup.appendChild(input);
        form.appendChild(inputGroup);
      });

      // Add submit button
      const submitButton = document.createElement('button');
      submitButton.type = 'submit';
      submitButton.className = 'submit-btn';
      submitButton.innerHTML = '<i class="fas fa-search"></i> Sorguyu Başlat';
      form.appendChild(submitButton);
    }

    // Initialize the form
    buildForm();

    // Form submission handler
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      // Show loading state
      defaultState.style.display = 'none';
      resultDiv.innerHTML = `
        <div class="loading">
          <div class="loading-spinner"></div>
          <p>Sorgu yapılıyor, lütfen bekleyin...</p>
        </div>
      `;

      // Prepare request body
      const body = { api };
      const inputs = apiInputs[api];
      
      if (inputs) {
        inputs.forEach(inputName => {
          const input = document.getElementById(inputName);
          body[inputName] = input ? input.value.trim() : '';
        });
      }

      try {
        const response = await fetch('/api/sorgu', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(body)
        });

        const result = await response.json();
        
        // Display results
        displayResults(result);
        
        // Update statistics
        updateStatistics();
        
      } catch (error) {
        console.error('Sorgu hatası:', error);
        resultDiv.innerHTML = `
          <div class="error-message">
            <i class="fas fa-exclamation-triangle"></i>
            <h3>Sorgu Hatası</h3>
            <p>${error.message || 'Bir hata oluştu. Lütfen tekrar deneyin.'}</p>
          </div>
        `;
      }
    });

    // Display results in a formatted way
    function displayResults(data) {
      console.log('Gelen veri:', data); // Debug için

      if (!data.success) {
        resultDiv.innerHTML = `
          <div class="error-message">
            <i class="fas fa-exclamation-triangle"></i>
            <h3>Sorgu Başarısız</h3>
            <p>${data.error || 'Bilinmeyen bir hata oluştu.'}</p>
          </div>
        `;
        return;
      }

      const results = data.data;

      // Eğer sonuç yoksa
      if (!results) {
        resultDiv.innerHTML = `
          <div class="success-message">
            <i class="fas fa-check-circle"></i>
            <h3>Sorgu Tamamlandı</h3>
            <p>Sonuç bulunamadı.</p>
          </div>
        `;
        return;
      }

      // String sonuçlar için
      if (typeof results === 'string') {
        resultDiv.innerHTML = `
          <div class="success-message">
            <i class="fas fa-check-circle"></i>
            <h3>Sorgu Tamamlandı</h3>
            <div class="json-result">
              <pre>${escapeHtml(results)}</pre>
            </div>
          </div>
        `;
        return;
      }

      // Array sonuçlar için
      if (Array.isArray(results)) {
        if (results.length === 0) {
          resultDiv.innerHTML = `
            <div class="success-message">
              <i class="fas fa-check-circle"></i>
              <h3>Sorgu Tamamlandı</h3>
              <p>Sonuç bulunamadı.</p>
            </div>
          `;
          return;
        }

        let html = '';
        results.forEach((item, index) => {
          html += renderResultItem(item, index + 1);
        });
        resultDiv.innerHTML = html;
        return;
      }

      // Object sonuçlar için
      if (typeof results === 'object') {
        resultDiv.innerHTML = renderResultItem(results, 1);
        return;
      }

      // Diğer durumlar
      resultDiv.innerHTML = `
        <div class="success-message">
          <i class="fas fa-check-circle"></i>
          <h3>Sorgu Tamamlandı</h3>
          <div class="json-result">
            <pre>${JSON.stringify(results, null, 2)}</pre>
          </div>
        </div>
      `;
    }

    // Tekil sonuç öğesini render et
    function renderResultItem(item, index) {
      let html = `<div class="result-item">`;
      
      // Başlık için özel durumlar
      let title = `Sonuç ${index}`;
      let icon = 'fas fa-user';
      
      // API türüne göre başlık ve ikon belirle
      if (api.includes('TC') || api.includes('Ad Soyad')) {
        if (item.ad && item.soyad) {
          title = `${item.ad} ${item.soyad}`;
        } else if (item.tc) {
          title = `TC: ${item.tc}`;
        }
        icon = 'fas fa-id-card';
      } else if (api.includes('GSM')) {
        if (item.gsm || item.telefon) {
          title = `Telefon: ${item.gsm || item.telefon}`;
        }
        icon = 'fas fa-phone';
      } else if (api.includes('Plaka')) {
        if (item.plaka) {
          title = `Plaka: ${item.plaka}`;
        }
        icon = 'fas fa-car';
      } else if (api.includes('Domain') || api.includes('IP')) {
        if (item.domain || item.ip) {
          title = `Domain/IP: ${item.domain || item.ip}`;
        }
        icon = 'fas fa-globe';
      } else if (api.includes('Email')) {
        if (item.email) {
          title = `E-posta: ${item.email}`;
        }
        icon = 'fas fa-envelope';
      } else if (api.includes('Aile') || api.includes('Eş') || api.includes('Sülale')) {
        icon = 'fas fa-users';
      } else if (api.includes('Adres')) {
        icon = 'fas fa-map-marker-alt';
      } else if (api.includes('Ehliyet')) {
        icon = 'fas fa-id-card';
      }
      
      html += `<div class="result-title"><i class="${icon}"></i> ${escapeHtml(title)}</div>`;
      
      if (typeof item === 'object' && item !== null) {
        // Ana bilgileri gruplandır
        const sections = {
          'Kişisel Bilgiler': ['tc', 'ad', 'soyad', 'dogum_tarihi', 'cinsiyet', 'uyruk'],
          'İletişim Bilgileri': ['telefon', 'gsm', 'email', 'adres'],
          'Aile Bilgileri': ['anne_adi', 'baba_adi', 'es_adi', 'cocuk_sayisi'],
          'Diğer Bilgiler': []
        };
        
        // Tüm anahtarları topla
        const allKeys = Object.keys(item);
        
        // Her bölüm için içerik oluştur
        Object.entries(sections).forEach(([sectionName, sectionKeys]) => {
          const sectionItems = {};
          
          sectionKeys.forEach(key => {
            if (item.hasOwnProperty(key) && item[key] !== null && item[key] !== undefined && item[key] !== '') {
              sectionItems[key] = item[key];
            }
          });
          
          // Eğer bölümde veri varsa göster
          if (Object.keys(sectionItems).length > 0) {
            html += `<div class="result-section">`;
            html += `<div class="section-title">${sectionName}</div>`;
            
            Object.entries(sectionItems).forEach(([key, value]) => {
              const displayValue = value !== null && value !== undefined ? 
                (typeof value === 'object' ? JSON.stringify(value, null, 2) : String(value)) : 
                '-';
              
              html += `
                <div class="result-field">
                  <span class="field-label">${formatFieldName(key)}:</span>
                  <span class="field-value">${escapeHtml(displayValue)}</span>
                </div>
              `;
            });
            
            html += `</div>`;
          }
        });
        
        // Diğer tüm anahtarları "Diğer Bilgiler" bölümüne ekle
        const otherKeys = allKeys.filter(key => 
          !Object.values(sections).flat().includes(key) && 
          item[key] !== null && 
          item[key] !== undefined && 
          item[key] !== ''
        );
        
        if (otherKeys.length > 0) {
          html += `<div class="result-section">`;
          html += `<div class="section-title">Diğer Bilgiler</div>`;
          
          otherKeys.forEach(key => {
            const displayValue = typeof item[key] === 'object' ? 
              JSON.stringify(item[key], null, 2) : 
              String(item[key]);
            
            html += `
              <div class="result-field">
                <span class="field-label">${formatFieldName(key)}:</span>
                <span class="field-value">${escapeHtml(displayValue)}</span>
              </div>
            `;
          });
          
          html += `</div>`;
        }
      } else {
        html += `
          <div class="result-field">
            <span class="field-value">${escapeHtml(String(item))}</span>
          </div>
        `;
      }
      
      html += `</div>`;
      return html;
    }

    // Alan adlarını daha okunabilir hale getir
    function formatFieldName(fieldName) {
      const fieldMap = {
        'tc': 'TC Kimlik No',
        'ad': 'Ad',
        'soyad': 'Soyad',
        'dogum_tarihi': 'Doğum Tarihi',
        'cinsiyet': 'Cinsiyet',
        'uyruk': 'Uyruk',
        'telefon': 'Telefon',
        'gsm': 'GSM',
        'email': 'E-posta',
        'adres': 'Adres',
        'anne_adi': 'Anne Adı',
        'baba_adi': 'Baba Adı',
        'es_adi': 'Eş Adı',
        'cocuk_sayisi': 'Çocuk Sayısı',
        'plaka': 'Plaka',
        'domain': 'Domain',
        'ip': 'IP Adresi',
        'kullanici_adi': 'Kullanıcı Adı',
        'okul_no': 'Okul No',
        'vergi_no': 'Vergi No',
        'imei': 'IMEI',
        'il': 'İl',
        'ilce': 'İlçe',
        'mahalle': 'Mahalle',
        'sokak': 'Sokak',
        'bina_no': 'Bina No',
        'daire_no': 'Daire No'
      };
      
      return fieldMap[fieldName] || fieldName.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
    }

    // HTML escape function
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    // Update statistics (mock data for now)
    function updateStatistics() {
      const queriesElem = document.getElementById('stat-queries');
      const successElem = document.getElementById('stat-success');
      const usersElem = document.getElementById('stat-users');
      
      // Increment counters
      const currentQueries = parseInt(queriesElem.textContent) || 0;
      const currentSuccess = parseInt(successElem.textContent) || 0;
      
      queriesElem.textContent = currentQueries + 1;
      successElem.textContent = currentSuccess + 1;
      
      // Random active users between 150-300
      usersElem.textContent = Math.floor(Math.random() * 150) + 150;
    }

    // Initialize statistics
    document.addEventListener('DOMContentLoaded', () => {
      updateStatistics();
      
      // Focus first input if exists
      const firstInput = form.querySelector('input');
      if (firstInput) {
        firstInput.focus();
      }
    });
  </script>
</body>
</html>
